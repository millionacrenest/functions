var gj = require('../index.js');

describe('just-get-json', function () {
  it('returns JS object', function (done) {
    var request = "http://jsonplaceholder.typicode.com/posts/1";
    var result = gj(request).userId;
    result.should.equal(1);
    done();
  });

  it('throws error if parsing not successfull', function (done) {
    // I know this test is ridiculous...
    var request = "http://example.com";
    try {
      var result = gj(request);
    } catch(e) {
      result = /Unexpected token/.test(e.message);
    }
    result.should.equal(true);
    done();
  });

  it('throws error if URL incorrect', function (done) {
    var request = "http:/example.com";
    try {
      var result = gj(request);
    } catch(e) {
      result = /The protocol/.test(e.message);
      result = result || /connect ECONNREFUSED/.test(e.message);
    }
    result.should.equal(true);
    done();
  });
});
